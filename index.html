<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pong</title>
  <style>
    body { margin: 0; background: black; color: white; font-family: sans-serif; text-align: center; }
    canvas { display: block; margin: auto; background: #222; }
    .menu { margin-top: 50px; }
    .menu button { font-size: 20px; margin: 10px; padding: 10px 20px; }
  </style>
</head>
<body>
  <div class="menu" id="menu">
    <h1>Pong</h1>
    <button onclick="startGame('1v1')">1 vs 1</button>
    <button onclick="startGame('playerVsBot')">Gracz vs Bot</button>
    <button onclick="startGame('botVsBot')">Bot vs Bot</button>
  </div>
  <canvas id="gameCanvas" width="800" height="500" style="display: none;"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    let up1 = false, down1 = false, up2 = false, down2 = false;
    let mode = "1v1";

    const paddleWidth = 10, paddleHeight = 100, ballSize = 10;
    let p1 = { x: 10, y: 200 }, p2 = { x: 780, y: 200 };
    let ball = { x: 395, y: 245, vx: 5, vy: 3 };
    let interval;

    function startGame(selectedMode) {
      mode = selectedMode;
      document.getElementById("menu").style.display = "none";
      canvas.style.display = "block";
      reset();
      interval = setInterval(gameLoop, 1000 / 60);
    }

    function reset() {
      p1.y = p2.y = canvas.height / 2 - paddleHeight / 2;
      ball.x = canvas.width / 2 - ballSize / 2;
      ball.y = canvas.height / 2 - ballSize / 2;
      ball.vx = Math.random() > 0.5 ? 5 : -5;
      ball.vy = (Math.random() * 4 - 2);
    }

    function gameLoop() {
      update();
      draw();
    }

    function update() {
      // Player input
      if (mode !== "botVsBot") {
        if (up1) p1.y -= 5;
        if (down1) p1.y += 5;
      }
      if (mode === "1v1") {
        if (up2) p2.y -= 5;
        if (down2) p2.y += 5;
      }

      // Bot logic
      if (mode === "playerVsBot" || mode === "botVsBot") {
        const target = ball.y - paddleHeight / 2;
        if (mode === "playerVsBot") {
          if (p2.y < target) p2.y += 4;
          if (p2.y > target) p2.y -= 4;
        } else {
          if (p1.y < target) p1.y += 4;
          if (p1.y > target) p1.y -= 4;
          if (p2.y < target) p2.y += 4;
          if (p2.y > target) p2.y -= 4;
        }
      }

      // Clamp paddles
      p1.y = Math.max(0, Math.min(canvas.height - paddleHeight, p1.y));
      p2.y = Math.max(0, Math.min(canvas.height - paddleHeight, p2.y));

      // Ball movement
      ball.x += ball.vx;
      ball.y += ball.vy;

      // Wall collision
      if (ball.y <= 0 || ball.y + ballSize >= canvas.height) ball.vy *= -1;

      // Paddle collision
      if (
        ball.x <= p1.x + paddleWidth &&
        ball.y + ballSize >= p1.y &&
        ball.y <= p1.y + paddleHeight
      ) {
        ball.vx *= -1;
        ball.x = p1.x + paddleWidth;
      }

      if (
        ball.x + ballSize >= p2.x &&
        ball.y + ballSize >= p2.y &&
        ball.y <= p2.y + paddleHeight
      ) {
        ball.vx *= -1;
        ball.x = p2.x - ballSize;
      }

      // Score reset (just reset position)
      if (ball.x < 0 || ball.x > canvas.width) reset();
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw paddles
      ctx.fillStyle = "white";
      ctx.fillRect(p1.x, p1.y, paddleWidth, paddleHeight);
      ctx.fillRect(p2.x, p2.y, paddleWidth, paddleHeight);

      // Draw ball
      ctx.fillRect(ball.x, ball.y, ballSize, ballSize);
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "w") up1 = true;
      if (e.key === "s") down1 = true;
      if (e.key === "ArrowUp") up2 = true;
      if (e.key === "ArrowDown") down2 = true;
    });

    document.addEventListener("keyup", (e) => {
      if (e.key === "w") up1 = false;
      if (e.key === "s") down1 = false;
      if (e.key === "ArrowUp") up2 = false;
      if (e.key === "ArrowDown") down2 = false;
    });
  </script>
</body>
</html>
